#this is just a simple test, calculate energy of two lowest states and see if the twopdms are calculated
# appropriately, here we are using fiedler restart, so this will test if the twopdm is printed correctly
echo "testing energy for c2_d2h..."
cd c2_d2h
../../block.spin_adapted dmrg.conf >dmrg.out
python ../test_energy.py 2  1.0e-6 -74.1299567218  -74.1255003600
echo "testing 2-pdm for c2_d2h..."
python ../test_twopdm.py spatial_twopdm.0.0 spat_twopdm.0.0.bkp 1e-7
python ../test_twopdm.py spatial_twopdm.1.1 spat_twopdm.1.1.bkp 1e-7
cd ../


#this just tests the lowest energy calculation. The run here uses no symmetry
echo "performing energy test on h2o..."
cd h2o_nosym
../../block.spin_adapted dmrg.conf >dmrg.out
python ../test_energy.py 1  1.0e-6 -76.11460447
cd ../

#test for hubbard model and also calculate the onepdm
echo "performing reorder, 1-pdm test on hubbard..."
cd hubbard
 ../../block.spin_adapted dmrg.conf >dmrg.out
python ../test_energy.py 1  1.0e-6 -6.56819216
python ../test_onepdm.py spatial_onepdm.0.0 spat_onepdm.0.0 1e-7
cd ../

echo "performing nonspinadapted test on hubbard..."
cd hubbard_nospin
 ../../block.spin_adapted dmrg.conf >dmrg.out
python ../test_energy.py 1  1.0e-6 -6.56819216
python ../test_onepdm.py spatial_onepdm.0.0 spat_onepdm.0.0 1e-7
cd ../



#this first calculated twopdm with a small M for two lowest states (so the energy is not converged)
#checks if the twopdm traced with integrals matches the energies
#then restarts the calculations to calculate the onepdm
#checks if the partially traced twopdm matches the calculated onepdm
echo "testing energy for c2_d2h_smallM..."
cd c2_d2h_smallM
 ../../block.spin_adapted dmrg.conf >dmrg.out
python test_twopdm_withe.py 
 ../../block.spin_adapted dmrg_fullrestart.conf >dmrg.out
python test_onepdm_withtwopdm.py 
cd ../

# this test is for non-particle number conserving BCS calculations
# check the ground state energy, onepdm, and pairing matrix
echo "testing energy for bcs calculation..."
cd bcs
 ../../block.spin_adapted dmrg.conf >dmrg.out
python ../test_energy.py 1  1.0e-6 -1.4816808342
echo "testing onepdm and pairing matrix for bcs calculation..."
python ../test_onepdm.py onepdm.0.0 ref_onepdm.0.0 1e-7
python ../test_onepdm.py spatial_pairmat.0.0 spat_pairmat.0.0 1e-7
cd ../

./clean
